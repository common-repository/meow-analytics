{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"React\"","webpack:///./js/src/auth.js","webpack:///./js/src/error.js","webpack:///./js/src/helpers.js","webpack:///./js/src/analytics.js","webpack:///./js/src/historical.js","webpack:///./js/src/realtime.js","webpack:///./js/src/dashboard.js","webpack:///./js/src/index.js","webpack:///external \"moment\""],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","React","AnalyticsAuth","wp","element","Component","props","state","connected","trackingId","meowAnalytics","tracking_id","expiresAt","expires_at","accessToken","access_token","refreshToken","gapi","analytics","ready","googleAuthorize","this","onSigningIn","auth","authorize","serverAuth","findViewId","Promise","resolve","reject","client","management","accounts","list","execute","results","error","username","items","map","x","accountId","id","accountName","debug_mode","console","log","webproperties","properties","webPropertyId","profiles","views","viewId","localStorageKey","mgaStore","localStorage","getItem","JSON","parse","getAccounts","account","getWebProperties","find","alert","getViews","setItem","stringify","setState","onSignIn","checkIfTokenExpires","jQuery","post","ajaxurl","action","freshSettings","setToken","now","Date","getTime","setTimeout","Fragment","Error","reset","message","style","whiteSpace","className","onClick","numberWithCommas","number","toString","replace","getUsersSessionsViews","fromDate","startDate","DayJS","subtract","endDate","months","diff","days","dimensions","ga","format","labels","users","sessions","pageviews","rows","row","label","datasets","borderColor","backgroundColor","fill","getActivityPerMinutes","request","realtime","formatThis","minutesAgo","index","parseInt","reverse","borderWidth","top","left","right","bottom","getRealtimeActivity","pages","page","totalsForAllResults","useState","useEffect","Historical","setViewId","setFromDate","setError","visible","setVisible","analyticsData","setAnalyticsData","refresh","onUpdate","onUpdated","chartOptions","legend","position","scales","yAxes","ticks","callback","tooltips","callbacks","item","FromDateLink","unit","newFromDate","href","textDecoration","class","marginBottom","options","CSS","activeNow","textAlign","fontSize","color","lineHeight","Realtime","dataIsOld","setDataIsOld","activityPerMinutes","setActivityPerMinutes","currentActivity","setCurrentActivity","onRefresh","all","perMinutes","activity","animate","display","xAxes","categoryPercentage","barPercentage","width","tab","justifyContent","boxSizing","borderRadius","tabItem","padding","marginRight","cursor","background","tabItemActive","Menu","setTab","busy","flex","visibility","margin","backgroundPosition","Dashboard","setBusy","onSignOut","render","Core","getNextRefresh","seconds","minutes","Math","round","document","addEventListener","event","container","getElementById","moment","e","code"],"mappings":"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","file":"index.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([137,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = React;","//import React from 'react';\n\nclass AnalyticsAuth extends wp.element.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { \n      connected: false,\n      trackingId: meowAnalytics.tracking_id,\n      expiresAt: meowAnalytics.expires_at,\n      accessToken: meowAnalytics.access_token,\n    };\n  }\n\n  componentDidMount() {\n    meowAnalytics.refreshToken = () => this.refreshToken();\n    gapi.analytics.ready(() => this.googleAuthorize());\n  }\n\n  async googleAuthorize() {\n    this.props.onSigningIn?.();\n    if (this.state.accessToken) {\n      gapi.analytics.auth.authorize({ serverAuth: { access_token: this.state.accessToken } });\n      return await this.findViewId();\n    }\n    return false;\n  }\n\n  async getAccounts() {\n    return new Promise((resolve, reject) => {\n      const request = gapi.client.analytics.management.accounts.list();\n      request.execute(results => {\n        if (results.error) {\n          reject(results.error);\n          return;\n        }\n        const username = results.username;\n        const accounts = results.items.map(x => { return { accountId: x.id, accountName: x.name } });\n        if ( meowAnalytics.debug_mode ) {\n          console.log('Meow Analytics: Account loaded.', username, accounts);\n        }\n        resolve({ username, accounts });\n      });\n    });\n  };\n  \n  async getWebProperties(accountId) {\n    return new Promise((resolve, reject) => {\n      const request = gapi.client.analytics.management.webproperties.list({ 'accountId': accountId });\n      request.execute(results => {\n        if (results.error) {\n          reject(results.error);\n          return;\n        }\n        const properties = results.items.map(x => { return { webPropertyId: x.id, accountId: x.accountId, name: x.name } });\n        resolve(properties);\n      });\n    });\n  };\n  \n  // Profiles\n  async getViews(accountId, webPropertyId) {\n    return new Promise((resolve, reject) => {\n      const request = gapi.client.analytics.management.profiles.list({ 'accountId': accountId, 'webPropertyId': webPropertyId });\n      request.execute(results => {\n        if (results.error) {\n          reject(results.error);\n          return;\n        }\n        const views = results.items.map(x => { return { viewId: x.id, accountId, webPropertyId } });\n        resolve(views);\n      });\n    });\n  };\n\n  // The Tracking Id doesn't work in the API, we absolutely need the View ID instead.\n  // After connection, this will look for the View ID that corresponds to the Tracking Id.\n  async findViewId() {\n    const localStorageKey = 'meow-analytics-' + this.state.trackingId;\n    let mgaStore = localStorage.getItem( localStorageKey );\n    try { mgaStore = JSON.parse( mgaStore ); } catch { mgaStore = null; }\n\n    if (!mgaStore) {\n      const { username, accounts } = await this.getAccounts();\n      const properties = [];\n      for ( let account of accounts )\n        properties.push(...await this.getWebProperties(account.accountId));\n      const property = properties.find(x => x.webPropertyId === this.state.trackingId);\n      if (!property) {\n        alert('Could not found the Tracking Id ' + this.state.trackingId + ' under this account.');\n        console.log('Tracking Id', this.state.trackingId, 'Properties', properties);\n        return false;\n      }\n      const views = await this.getViews( property.accountId, property.webPropertyId );\n      if ( meowAnalytics.debug_mode ) {\n        console.log('Meow Analytics: Found ViewID.', views[0] );\n      }\n      mgaStore = { username, viewId: views[0].viewId };\n      localStorage.setItem( localStorageKey, JSON.stringify( mgaStore ) );\n    }\n    if ( meowAnalytics.debug_mode ) {\n      console.log('Meow Analytics: Ready.', this.state);\n    }\n    this.setState({ connected: true });\n    this.props.onSignIn( mgaStore.viewId );\n    this.checkIfTokenExpires();\n    return true;\n  }\n\n  async refreshToken() {\n    let freshSettings = await jQuery.post(ajaxurl, { action: 'mga_refresh_token' });\n    freshSettings = JSON.parse(freshSettings);\n    meowAnalytics.expires_at = freshSettings.expires_at;\n    meowAnalytics.access_token = freshSettings.access_token;\n    this.setState({\n      trackingId: freshSettings.tracking_id,\n      expiresAt: freshSettings.expires_at,\n      accessToken: freshSettings.access_token\n    });\n    gapi.client.setToken({ access_token: freshSettings.access_token });\n    const results = await this.getAccounts();\n    if (!results.username) {\n      return false;\n    }\n    if ( meowAnalytics.debug_mode ) {\n      console.log('Meow Analytics: Token updated.', this.state);\n    }\n    return true;\n  }\n\n  async checkIfTokenExpires() {\n    if (!this.state.connected) {\n      return;\n    }\n    const now = (new Date()).getTime() / 1000;\n    const left = this.state.expiresAt - now;\n    if ( left < ( 60 * 5 ) ) {\n      let success = await this.refreshToken();\n      if (!success) {\n        console.log('Meow Analytics: Failed to refresh, will not retry.');\n        return;\n      }\n    }\n    setTimeout(() => this.checkIfTokenExpires(), 30 * 1000);\n  }\n\n  render() {\n    return (<div></div>);\n  }\n}\n\nexport default AnalyticsAuth;","const { Fragment } = wp.element;\n\nconst Error = (props) => {\n  const { error, reset } = props;\n  \n  return (<Fragment>\n    {/* Error coming from Google Anlytics API */}\n    {error && error.message && \n      <div>\n        <p>Received an error:</p>\n        <pre style={{ whiteSpace: 'inherit' }}>{error.message}</pre>\n      </div>\n    }\n    {/* Error coming from Meow Analytics directly */}\n    {error && !error.message && <div><p>{error}</p></div>}\n    {/* Button that will reset the error */}\n    {error && <div className='button' onClick={reset}>Try again</div>}\n  </Fragment>);\n};\n\nexport default Error;\n","const numberWithCommas = (number) => {\n\treturn number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n};\n\nexport { numberWithCommas };","import DayJS from 'dayjs';\n\nconst getUsersSessionsViews = async (viewId, fromDate = null) => {\n  let startDate = fromDate ? fromDate : DayJS().subtract(7, 'day');\n  let endDate = DayJS().subtract(1, 'day');\n  let months = endDate.diff(startDate, \"month\"); \n  let days = endDate.diff(startDate, \"day\"); \n\n  return new Promise((resolve, reject) => {\n\n    let dimensions = 'ga:hour';\n    if (months > 12)\n      dimensions = 'ga:year';\n    else if (months > 1)\n      dimensions = 'ga:yearMonth';\n    else if (days > 1)\n      dimensions = 'ga:date';\n\n    let request = gapi.client.analytics.data.ga.get({ \n      'ids':  'ga:' + viewId,\n      'start-date': dimensions === 'ga:hour' ? 'today' : startDate.format('YYYY-MM-DD'),\n      'end-date': dimensions === 'ga:hour' ? 'today' : endDate.format('YYYY-MM-DD'),\n      'metrics': 'ga:users,ga:sessions,ga:pageviews',\n      'dimensions': dimensions\n    });\n    request.execute(results => {\n      const labels = [];\n      const users = [];\n      const sessions = [];\n      const pageviews = [];\n      if (results.error) {\n        reject(results.error);\n        return;\n      }\n      for (let row of results.rows) {\n        let label = row[0];\n        if (label.length === 8)\n          label = DayJS(label).format('MMM DD'); \n        else if (label.length === 6)\n          label = DayJS(label + '01').format('MMM YYYY'); \n        else if (label.length === 4)\n          label = label; \n        labels.push(label);\n        users.push(row[1]);\n        sessions.push(row[2]);\n        pageviews.push(row[3]);\n      }\n      resolve({ labels, datasets: [\n        { \n          label: 'Users',\n          borderColor: 'rgba(100, 169, 241, 1)',\n          backgroundColor: 'rgba(100, 169, 241, 0.2)',\n          fill: false,\n          data: users \n        }, {\n          label: 'Sessions', \n          borderColor: 'rgba(241, 188, 100, 1)',\n          backgroundColor: 'rgba(241, 188, 100, 0.2)',\n          fill: false,\n          data: sessions\n        }, {\n          label: 'Views', \n          borderColor: 'rgba(37, 180, 125, 1)',\n          backgroundColor: 'rgba(37, 180, 125, 0.2)',\n          fill: false,\n          data: pageviews\n        }] \n      });\n    });\n  });\n};\n\n// Get activity for the last 30 minutes\nconst getActivityPerMinutes = async (viewId) => {\n  return new Promise((resolve, reject) => {\n    let request = gapi.client.analytics.data.realtime.get({ \n      'ids':  'ga:' + viewId,\n      'metrics': 'rt:pageviews',\n      'dimensions': 'rt:minutesAgo' // ga:medium,rt:referralPath,rt:trafficType,\n    });\n    const formatThis = (minutesAgo) => {\n      return DayJS().subtract(minutesAgo, 'minute').format('HH:mm');\n    }\n    request.execute(results => {\n      let minutesAgo = [];\n      let pageviews = [];\n      if (results.error) {\n        reject(results.error);\n        return;\n      }\n      for (let index = 0; index < 30; index++) {\n        let row = results.rows?.find(x => parseInt(x[0]) === index);\n        minutesAgo.push(row ? formatThis(parseInt(row[0])) : formatThis(index));\n        pageviews.push(row ? parseInt(row[1]) : 0);\n      }\n      minutesAgo = minutesAgo.reverse();\n      pageviews = pageviews.reverse();\n      const activityPerMinutes = { labels: minutesAgo, datasets: [{ \n          label: 'Views',\n          borderWidth: { top: 5, left: 0, right: 0, bottom: 0 },\n          borderColor: 'rgba(100, 169, 241, 1)',\n          backgroundColor: 'rgba(100, 169, 241, 0.75)',\n          fill: true,\n          data: pageviews \n        }] \n      };\n      resolve(activityPerMinutes);\n    });\n  });\n};\n\n// Get current activity (active users and pages)\nconst getRealtimeActivity = async (viewId) => {\n  return new Promise((resolve, reject) => {\n    let request = gapi.client.analytics.data.realtime.get({ \n      'ids':  'ga:' + viewId,\n      'metrics': 'rt:activeUsers',\n      'dimensions': 'rt:pagePath', // ,ga:medium,rt:referralPath,rt:trafficType,rt:source\n    });\n    request.execute(results => {\n      const pages = results.rows?.map(x => ({ page: x[0], users: parseInt([1]) }));\n      resolve({ users: parseInt(results.totalsForAllResults ? results.totalsForAllResults['rt:activeUsers'] : 0), pages });\n    });\n  });\n};\n\nexport { getUsersSessionsViews, getActivityPerMinutes, getRealtimeActivity };","const { useState, useEffect } = wp.element;\n\nimport DayJS from 'dayjs';\nimport { Line } from 'react-chartjs-2';\n\nimport Error from './error';\nimport { numberWithCommas } from './helpers';\nimport { getUsersSessionsViews } from './analytics';\n\n\nconst Historical = (props) => {\n  const [ viewId, setViewId ] = useState();\n  const [ fromDate, setFromDate ] = useState(DayJS().subtract(1, 'week'));\n  const [ error, setError ] = useState();\n  const [ visible, setVisible ] = useState();\n  const [ analyticsData, setAnalyticsData ] = useState();\n\n  const refresh = async () => {\n    try {\n      if (viewId && fromDate) {\n        props.onUpdate?.();\n        setAnalyticsData(await getUsersSessionsViews(viewId, fromDate));\n      }\n    }\n    catch (err) {\n      setError(err);\n    }\n    finally {\n      props.onUpdated?.();\n    }\n  };\n\n  const chartOptions = {\n    legend: { position: 'bottom' },\n    scales: {\n      yAxes: [{ ticks: { callback: (value) => numberWithCommas(value) } }]\n    },\n    tooltips: {\n      callbacks: { label: (item) => ' ' + numberWithCommas(item.value) }\n    }\n  };\n\n  useEffect(() => { refresh() }, [ viewId, fromDate ]);\n  useEffect(() => setViewId(props.viewId), [ props.viewId ]);\n  useEffect(() => setVisible(props.visible), [ props.visible ]);\n\n  const FromDateLink = (props) => {\n    const { value, unit, label } = props;\n    const newFromDate = DayJS().subtract(value, unit);\n    const onClick = () => setFromDate(newFromDate);\n    if ( fromDate.format('YYYYMMDD') === newFromDate.format('YYYYMMDD'))\n      return (<span>{label}</span>);\n    return (<a onClick={onClick} href=\"#\" style={{ textDecoration: 'none' }}>{label}</a>);\n  }\n\n\treturn visible ? (\n    <div class='meow-analytics-dashboard-block'>\n\n      {/* Menu */}\n      <div style={{ marginBottom: '10px' }}>\n        <FromDateLink value='24' unit='hour' label='24 hours' /> |&nbsp;\n        <FromDateLink value='1' unit='week' label='1 week' /> |&nbsp;\n        <FromDateLink value='1' unit='month' label='1 month' /> |&nbsp;\n        <FromDateLink value='6' unit='month' label='6 month' /> |&nbsp;\n        <FromDateLink value='1' unit='year' label='1 year' /> |&nbsp;\n        <FromDateLink value='10' unit='years' label='10 years' />\n      </div>\n\n      {/* Display errors */}\n      <Error error={error} reset={() => setError()} />\n\n      {/* Display chart */}\n      {!error && analyticsData &&\n        <Line data={analyticsData} options={chartOptions} />\n      }\n\n    </div>\n  ) : null;\n}\n\nexport default Historical;","const { useState, useEffect } = wp.element;\n\nimport { Bar } from 'react-chartjs-2';\n\nimport Error from './error';\nimport { numberWithCommas } from './helpers';\nimport { getActivityPerMinutes, getRealtimeActivity } from './analytics';\n\nconst CSS = {\n  activeNow: {\n    textAlign: 'center',\n    fontSize: '34px',\n    color: '#007cba',\n    marginBottom: '10px',\n    lineHeight: '20px'\n  }\n};\n\nconst Realtime = (props) => {\n  const [ viewId, setViewId ] = useState(null);\n  const [ error, setError ] = useState();\n  const [ visible, setVisible ] = useState(false);\n  const [ dataIsOld, setDataIsOld ] = useState(true);\n  const [ activityPerMinutes, setActivityPerMinutes ] = useState();\n  const [ currentActivity, setCurrentActivity ] = useState();\n\n  const onRefresh = async () => {\n    try {\n      if (viewId) {\n        const [ perMinutes, activity ] = await Promise.all([ getActivityPerMinutes(viewId), getRealtimeActivity(viewId) ]);\n        setDataIsOld(false);\n        setActivityPerMinutes(perMinutes);\n        setCurrentActivity({ users: activity.users, pages: activity.pages });\n        setTimeout(() => setDataIsOld(true), 10000);\n      }\n    } \n    catch (err) {\n      setError(err);\n      console.log(err);\n    }\n  };\n\n  const chartOptions = {\n    animate: false,\n    legend: { display: false },\n    scales: {\n      xAxes: [{\n        categoryPercentage: 1.0,\n        barPercentage: 1.0\n      }],\n      yAxes: [{ \n        ticks: { callback: (value) => numberWithCommas(value) } \n      }]\n    },\n    tooltips: {\n      callbacks: { label: (item) => ' ' + numberWithCommas(item.value) }\n    }\n  };\n\n  // Effects\n  useEffect(() => setViewId(props.viewId), [ props.viewId ]);\n  useEffect(() => setVisible(props.visible), [ props.visible ]);\n  useEffect(() => {\n    if (!error && viewId && visible && dataIsOld) {\n      onRefresh();\n    }\n  }, [ error, viewId, visible, dataIsOld ]);\n\n\treturn visible ? (\n    <div class='meow-analytics-dashboard-block'>\n\n      {/* Display errors */}\n      <Error error={error} reset={() => setError(null)} />\n\n      {/* Display chart */}\n      {!error && currentActivity && activityPerMinutes &&\n        <div>\n          <div style={CSS.activeNow}>{currentActivity.users}<br />\n            <small style={{ fontSize: '14px' }}>active users on site</small>\n          </div>\n          <div>            \n            <div style={{ marginBottom: '10px' }}><Bar data={activityPerMinutes} options={chartOptions} /></div>\n            <table style={{ marginBottom: '10px' }} class=\"wp-list-table widefat striped\">\n              <thead><tr><td>Page</td><td style={{ width: '40px' }}>Users</td></tr></thead>\n              <tbody>{currentActivity.pages?.map(x => <tr><td>{x.page}</td><td>{x.users}</td></tr> )}</tbody>\n            </table>\n          </div>\n        </div>\n      }\n\n    </div>\n  ) : null;\n}\n\nexport default Realtime;","const { Fragment, useState } = wp.element;\n\nimport AnalyticsAuth from './auth';\nimport Historical from './historical';\nimport Realtime from './realtime';\n\nconst CSS = {\n  tab: {\n    display: 'flex',\n    justifyContent: 'start',\n    marginBottom: '10px',\n    boxSizing: 'border-box',\n    borderRadius: '10px;'\n  },\n  tabItem: {\n    padding: '2px 10px',\n    marginRight: '5px',\n    color: 'white',\n    cursor: 'pointer',\n    background: '#64a9f1'\n  },\n  tabItemActive: {\n    padding: '2px 10px',\n    marginRight: '5px',\n    color: 'white',\n    cursor: 'pointer',\n    background: '#007cba'\n  }\n};\n\nconst Menu = (props) => {\n  const { tab, setTab, busy } = props;\n  return (\n    <div style={CSS.tab}>\n      <div style={tab === 'historical' ? CSS.tabItemActive : CSS.tabItem} onClick={() => setTab('historical')}>Historical</div>\n      <div style={tab === 'realtime' ? CSS.tabItemActive : CSS.tabItem} onClick={() => setTab('realtime')}>Realtime</div>\n      {busy && <span className=\"spinner\" style={{ textAlign: 'right', flex: 1, visibility: 'visible', margin: '1px 0px', backgroundPosition: 'right' }} />}\n    </div>\n  );\n}\n\nconst Dashboard = () => {\n  const [ busy, setBusy ] = useState(false);\n  const [ viewId, setViewId ] = useState();\n  const [ tab, setTab ] = useState('historical');\n\n\treturn (\n    <Fragment>\n      <Menu tab={tab} setTab={setTab} busy={busy} />\n      <Fragment>\n        <Historical visible={tab === 'historical'} viewId={viewId} onUpdate={() => setBusy(true)} onUpdated={() => setBusy(false)} />\n        <Realtime visible={tab === 'realtime'} viewId={viewId} />\n      </Fragment>\n      <AnalyticsAuth onSignIn={(viewId) => setViewId(viewId)} onSignOut={() => setViewId(null)} />\n    </Fragment>\n  );\n}\n\nexport default Dashboard;","const { render } = wp.element;\n\nimport Dashboard from './dashboard';\n\nconst Core = () => {\n\n\t// Debugging mode: add a function to track the next token refresh\n\tif ( meowAnalytics.debug_mode ) {\n\t\tmeowAnalytics.getNextRefresh = () => {\n\t\t\tconst now = (new Date()).getTime() / 1000;\n\t\t\tconst seconds = meowAnalytics.expires_at - now;\n\t\t\tconst minutes = Math.round(seconds / 60);\n\t\t\tif ( minutes > 0 )\n\t\t\t\treturn (`Meow Analytics: ${minutes}mn left before next token refresh.`);\n\t\t\telse if ( seconds > 0 )\n\t\t\t\treturn (`Meow Analytics: ${seconds}s left before next token refresh.`);\n\t\t\telse\n\t\t\t\treturn (`Meow Analytics: The token has expired, and wasn't refreshed,`, seconds);\n\t\t};\n\t}\n\n\treturn ( <Dashboard /> );\n}\n\ndocument.addEventListener('DOMContentLoaded', function(event) {\n\tlet container = document.getElementById('meow-analytics-container');\n\tif (container) {\n\t\trender((<Core />), container);\n\t}\n});\n","if(typeof moment === 'undefined') {var e = new Error(\"Cannot find module 'moment'\"); e.code = 'MODULE_NOT_FOUND'; throw e;}\nmodule.exports = moment;"],"sourceRoot":""}